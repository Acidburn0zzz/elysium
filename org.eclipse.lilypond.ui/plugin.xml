<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.0"?>
<plugin>
    <extension
     point="org.eclipse.ui.editors">
        <editor
         class="org.lilypond.LilyPondExecutableExtensionFactory:org.eclipse.xtext.ui.core.editor.XtextEditor"
         contributorClass="org.eclipse.ui.editors.text.TextEditorActionContributor"
         default="true"
         extensions="ly,ily"
         icon="icons/labeling/LilyPond.png"
         id="org.lilypond.editors.LilyPond"
         name="LilyPond Editor">
        </editor>
    </extension>
    <extension
     point="org.eclipse.ui.views">
        <category
         id="org.lilypond.viewCategories.LilyPond"
         name="LilyPond">
        </category>
        <view
         category="org.lilypond.viewCategories.LilyPond"
         class="org.lilypond.score.ScoreView"
         icon="icons/score/ScoreView.png"
         id="org.lilypond.views.Score"
         name="Score"
         restorable="true">
        </view>
    </extension>
    <extension
     point="org.eclipse.ui.perspectives">
        <perspective
         class="org.lilypond.LilyPondPerspective"
         icon="icons/LilyPondPerspective.png"
         id="org.lilypond.perspectives.LilyPond"
         name="LilyPond">
        </perspective>
    </extension>
    <extension
     point="org.eclipse.ui.perspectiveExtensions">
        <perspectiveExtension
         targetID="org.lilypond.perspectives.LilyPond">
            <view
             id="org.eclipse.ui.navigator.ProjectExplorer"
             minimized="false"
             ratio="0.2"
             relationship="left"
             relative="org.eclipse.ui.editorss">
            </view>
            <view
             id="org.eclipse.ui.views.ProblemView"
             minimized="false"
             ratio="0.75"
             relationship="bottom"
             relative="org.eclipse.ui.editorss">
            </view>
            <view
             id="org.eclipse.ui.console.ConsoleView"
             minimized="false"
             ratio="0.5"
             relationship="right"
             relative="org.eclipse.ui.views.ProblemView">
            </view>
            <view
             id="org.lilypond.views.Score"
             minimized="false"
             ratio="0.65"
             relationship="right"
             relative="org.eclipse.ui.editorss">
            </view>
        </perspectiveExtension>
    </extension>
    <extension
     point="org.eclipse.ui.commands">
        <command
         description="Trigger expensive validation"
         id="org.lilypond.commands.Validate"
         name="Validate">
        </command>
        <command
         description="Compiles the currently open file with LilyPond"
         id="org.lilypond.commands.Compile"
         name="&amp;Compile">
        </command>
    </extension>
    <extension
     point="org.eclipse.ui.handlers">
        <handler
         class="org.lilypond.LilyPondExecutableExtensionFactory:org.eclipse.xtext.ui.common.editor.hyperlinking.OpenDeclarationHandler"
         commandId="org.eclipse.xtext.ui.common.editor.hyperlinking.OpenDeclaration">
            <activeWhen>
                <reference
                 definitionId="org.lilypond.definitions.EditorOpen">
                </reference>
            </activeWhen>
        </handler>
        <handler
         class="org.lilypond.LilyPondExecutableExtensionFactory:org.eclipse.xtext.ui.core.editor.handler.ValidateActionHandler"
         commandId="org.lilypond.commands.Validate">
            <activeWhen>
                <reference
                 definitionId="org.lilypond.definitions.EditorOpen">
                </reference>
            </activeWhen>
        </handler>
        <handler
         class="org.lilypond.compiler.CompileHandler"
         commandId="org.lilypond.commands.Compile">
        </handler>
    </extension>
    <extension
     point="org.eclipse.ui.commandImages">
        <image
         commandId="org.lilypond.commands.Compile"
         icon="icons/compiler/CompileCommand.png">
        </image>
    </extension>
    <extension
     point="org.eclipse.ui.bindings">
        <key
         commandId="org.lilypond.commands.Compile"
         contextId="org.eclipse.ui.contexts.window"
         schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
         sequence="M1+T">
        </key>
    </extension>
    <extension
     point="org.eclipse.ui.menus">
        <menuContribution
         locationURI="popup:#TextEditorContext?after=group.open">
            <command
             commandId="org.lilypond.commands.Validate"
             style="push">
                <visibleWhen
                 checkEnabled="false">
                    <reference
                     definitionId="org.lilypond.definitions.EditorOpen">
                    </reference>
                </visibleWhen>
            </command>
        </menuContribution>
        <menuContribution
         locationURI="toolbar:org.eclipse.ui.main.toolbar">
            <toolbar
             id="org.lilypond.toolbar">
                <command
                 commandId="org.lilypond.commands.Compile"
                 style="push">
                    <visibleWhen
                     checkEnabled="false">
                        <with
                         variable="activeEditorId">
                            <equals
                             value="org.lilypond.editors.LilyPond">
                            </equals>
                        </with>
                    </visibleWhen>
                </command>
            </toolbar>
        </menuContribution>
        <menuContribution
         locationURI="menu:org.eclipse.ui.main.menu">
            <menu
             id="org.lilypond.menu"
             label="&amp;LilyPond">
                <visibleWhen
                 checkEnabled="false">
                    <with
                     variable="activeEditorId">
                        <equals
                         value="org.lilypond.editors.LilyPond">
                        </equals>
                    </with>
                </visibleWhen>
                <command
                 commandId="org.lilypond.commands.Compile"
                 style="push">
                </command>
            </menu>
        </menuContribution>
    </extension>
    <extension
     point="org.eclipse.core.runtime.preferences">
        <initializer
         class="org.lilypond.compiler.CompilerPreferenceInitializer">
        </initializer>
    </extension>
    <extension
     point="org.eclipse.ui.preferencePages">
        <page
         class="org.eclipse.xtext.ui.core.editor.preferences.EmptyPreferencePage"
         id="org.lilypond.preferencePages.LilyPond"
         name="LilyPond">
            <keywordReference id="org.lilypond.keywords.LilyPond"/>
        </page>
        <page
         category="org.lilypond.preferencePages.LilyPond"
         class="org.lilypond.compiler.CompilerPreferencePage"
         id="org.lilypond.preferencePages.Compiler"
         name="Compiler">
            <keywordReference
             id="org.lilypond.keywords.LilyPond">
            </keywordReference>
        </page>
        <page
         category="org.lilypond.preferencePages.LilyPond"
         class="org.lilypond.LilyPondExecutableExtensionFactory:org.eclipse.xtext.ui.common.editor.syntaxcoloring.SyntaxColoringPreferencePage"
         id="org.lilypond.preferencePages.SyntaxColoring"
         name="Syntax Coloring">
            <keywordReference id="org.lilypond.keywords.LilyPond"/>
        </page>
        <page
         category="org.lilypond.preferencePages.LilyPond"
         class="org.lilypond.LilyPondExecutableExtensionFactory:org.eclipse.xtext.ui.common.editor.templates.XtextTemplatePreferencePage"
         id="org.lilypond.preferencePages.Templates"
         name="Templates">
            <keywordReference
             id="org.lilypond.keywords.LilyPond">
            </keywordReference>
        </page>
    </extension>
    <extension
     point="org.eclipse.ui.keywords">
        <keyword
         id="org.lilypond.keywords.LilyPond"
         label="LilyPond"/>
    </extension>
    <extension
     point="org.eclipse.core.expressions.definitions">
        <definition
         id="org.lilypond.definitions.EditorOpen">
            <and>
                <reference
                 definitionId="isActiveEditorAnInstanceOfXtextEditor">
                </reference>
                <with
                 variable="activeEditor">
                    <test
                     forcePluginActivation="true"
                     property="org.eclipse.xtext.ui.core.editor.XtextEditor.languageName"
                     value="org.lilypond.LilyPond">
                    </test>
                </with>
            </and>
        </definition>
    </extension>
    <!-- adding resource factories -->
    <extension
     point="org.eclipse.emf.ecore.extension_parser">
        <parser
         class="org.lilypond.LilyPondExecutableExtensionFactory:org.eclipse.xtext.resource.XtextResourceFactory"
         type="ly">
        </parser>
    </extension>
    <extension
     id="LilyPondProblemMarker"
     name="LilyPond Problem"
     point="org.eclipse.core.resources.markers">
        <super
         type="org.eclipse.core.resources.problemmarker">
        </super>
        <attribute
         name="columnNumber">
        </attribute>
        <persistent
              value="true">
        </persistent>
    </extension>
    <extension
     point="org.eclipse.ui.activities">
        <activity
         id="org.lilypond.activities.Editing"
         name="LilyPond Editing">
        </activity>
        <activityPatternBinding
         activityId="org.lilypond.activities.Editing"
         pattern="org.eclipse.lilypond.ui/org.lilypond.preferencePages.SyntaxColoring">
        </activityPatternBinding>
    </extension>
</plugin>
